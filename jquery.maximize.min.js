jQuery(function(e){e.fn.maximize=function(q){if(!this.length)return this;var a=e.extend({},e.fn.maximize.defaults,q);return this.each(function(){var c=e(this).find("img"),i=e(this),j=i.find("div"),r=j.outerHeight(true)-j.height(),k=c.outerWidth(true)-c.width(),l=c.outerHeight(true)-c.height(),m={},n={},o;m[a.align]=0;n[a.align]=0;e(this).css(e.extend({position:"fixed",top:0,width:"100%",height:"100%",overflow:"hidden"},m));c.hide().css(e.extend({position:"absolute",top:0,left:0,visibility:"hidden"},
n));var p=function(){var f=e(window).height(),h=e(window).width(),b,d,g=i.data("img_size")||{width:c.width(),height:c.height(),ratio:c.width()/c.height()};j.length&&j.height(f-r);f=j.height();h=j.width();b=h/f;i.trigger("maximizerResize",[h,f]);if(a.resize==="crop")if(b>g.ratio){b=h;d=h/g.ratio}else{b=f*g.ratio;d=f}else if(b<g.ratio){b=h-k;if(a.zoomInLimit>0&&b>g.width*a.zoomInLimit)b=g.width*a.zoomInLimit;if(a.maxWidth>0&&b>a.maxWidth)b=a.maxWidth;d=b/g.ratio-l;if(a.maxHeight>0&&d>a.maxHeight){d=
a.maxHeight;b=d*g.ratio}}else{d=f-l;if(a.zoomInLimit>0&&d>g.height*a.zoomInLimit)d=g.height*a.zoomInLimit;if(a.maxHeight>0&&d>a.maxHeight)d=a.maxHeight;b=d*g.ratio-k;if(a.maxWidth>0&&b>a.maxWidth){b=a.maxWidth;d=b/g.ratio}}c.width(b).height(d);e.inArray(a.center,["both","horizontal"])!==-1&&c.css({left:(h-b)/2});e.inArray(a.center,["both","vertical"])!==-1&&c.css({top:(f-d)/2})};o=setInterval(function(){var f,h,b;if(c[0].complete){f=c.width();h=c.height();b=f/h;i.data("img_size",{width:f,height:h,
ratio:b});p();i.trigger("beforeShow");c.css({visibility:"visible"}).fadeIn(500,function(){i.trigger("afterShow")});clearInterval(o)}},50);e(window).bind("resize",function(){p()})})};e.fn.maximize.defaults={center:"both",align:"left",resize:"crop",zoomInLimit:0,maxWidth:0,maxHeight:0}});
