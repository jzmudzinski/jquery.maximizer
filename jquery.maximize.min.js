jQuery(function(c){c.fn.maximize=function(q){if(!this.length)return this;var a=c.extend({},c.fn.maximize.defaults,q);return this.each(function(){var h=c(this).find("img"),j=c(this),k=j.find("div"),l=c.map("marginTop marginRight marginBottom marginLeft".split(" "),function(d){return parseInt(k.css(d),10)}),i=c.map("borderTopWidth borderRightWidth borderBottomWidth borderLeftWidth".split(" "),function(d){return parseInt(h.css(d),10)}),m={},n={},o;m[a.align]=0;n[a.align]=0;c(this).css(c.extend({position:"fixed",
top:0,width:"100%",height:"100%",overflow:"hidden"},m));h.hide().css(c.extend({position:"absolute",top:0,left:0,visibility:"hidden"},n));var p=function(){var d=c(window).height(),e=c(window).width(),b,f,g=j.data("img_size");k.length&&k.height(d-l[0]-l[2]);d=k.height();e=k.width();b=e/d;j.trigger("maximizerResize",[e,d]);if(a.resize==="crop")if(b>g.ratio){b=e;f=e/g.ratio}else{b=d*g.ratio;f=d}else if(b<g.ratio){b=e-i[1]-i[3];if(a.zoomInLimit>0&&b>g.width*a.zoomInLimit)b=g.width*a.zoomInLimit;if(a.maxWidth>
0&&b>a.maxWidth)b=a.maxWidth;f=b/g.ratio-i[0]-i[2]}else{f=d-i[0]-i[2];if(a.zoomInLimit>0&&f>g.height*a.zoomInLimit)f=g.height*a.zoomInLimit;if(a.maxHeight>0&&f>a.maxHeight)f=a.maxHeight;b=f*g.ratio-i[1]-i[3]}h.width(b).height(f);c.inArray(a.center,["both","horizontal"])!==-1&&h.css({left:(e-b)/2});c.inArray(a.center,["both","vertical"])!==-1&&h.css({top:(d-f)/2})};o=setInterval(function(){var d,e,b;if(h[0].complete){d=h.width();e=h.height();b=d/e;j.data("img_size",{width:d,height:e,ratio:b});p();
j.trigger("beforeShow");h.css({visibility:"visible"}).fadeIn(500,"swing");clearInterval(o)}},50);c(window).bind("resize",function(){p()})})};c.fn.maximize.defaults={center:"both",align:"left",resize:"crop",zoomInLimit:2,maxWidth:400,maxHeight:0}});
